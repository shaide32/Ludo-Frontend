(this.webpackJsonpludo=this.webpackJsonpludo||[]).push([[0],{17:function(t,e,n){},18:function(t,e,n){},21:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var i=n(2),o=n.n(i),s=n(11),a=n.n(s),r=(n(17),n(4)),l=n(5),u=n(3),c=function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(u.a)(this,t),this.id=e,this.cellType=n,this.safeFor=i,this.homeFor=o,this.station=s},p="NORMAL",d="SAFE",f="HOME",b="RED",h="BLUE",x="GREEN",j="YELLOW",m="Not Started",y="active",O="finished",g="Not Started",v="finished",k="Waiting for dice",w="Waiting for token",T=0,S=function(t,e){var n=0,i=[];for(i.push(new c(T++,p)),i.push(new c(T++,d,t,null,!0)),n=0;n<7;n++)i.push(new c(T++,p));for(i.push(new c(T++,null,null,null,!0)),n=0;n<3;n++)i.push(new c(T++,p));for(n=0;n<5;n++)i.push(new c(T++,d,e));return i.push(new c(T++,f,e,e)),i},_=function(t){var e={position:"absolute"};return t.id<6?(e.left="300px",e.bottom=50*t.id+"px"):t.id>=69&&t.id<=75?(e.bottom=50*(t.id-69)+"px",75===t.id?e.left="300px":e.left="350px"):t.id>=63&&t.id<=68?(e.left="400px",e.bottom=250-50*(t.id-63)+"px"):t.id>=6&&t.id<=11?(e.left=250-50*(t.id-6)+"px",e.top="400px"):t.id>=12&&t.id<=18?(e.left=50*(t.id-12)+"px",18===t.id?e.top="300px":e.top="350px"):t.id>=19&&t.id<=24?(e.left=50*(t.id-19)+"px",e.top="300px"):t.id>=25&&t.id<=30?(e.left="300px",e.bottom=450+50*(t.id-25)+"px"):t.id>=31&&t.id<=37?37===t.id?(e.left="300px",e.bottom=674-50*(t.id-31)+"px"):(e.left="350px",e.bottom=700-50*(t.id-31)+"px"):t.id>=38&&t.id<=43?(e.left="400px",e.bottom=700-50*(t.id-38)+"px"):t.id>=44&&t.id<=49?(e.left=450+50*(t.id-44)+"px",e.top="300px"):t.id>=50&&t.id<=56?56===t.id?(e.left=624-50*(t.id-51)+"px",e.top="300px"):(e.left=650-50*(t.id-51)+"px",e.top="350px"):t.id>=57&&t.id<=62&&(e.left=700-50*(t.id-57)+"px",e.top="400px"),e},N=function t(e,n,i,o,s,a){Object(u.a)(this,t),this.id=e,this.label=n,this.tokenRemaining=1,this.startCell=i,this.endCell=o,this.homeStartCell=s,this.skippedCells=a},C=function t(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m;Object(u.a)(this,t),this.id=e,this.player_id=n,this.position=i,this.status=o,this.focussed=!1},F=(n(18),n(0)),L=function(t){var e={};return t===b?(e.left="0px",e.bottom="0px"):t===x?(e.left="0px",e.top="0px"):t===j?(e.right="0px",e.top="0px"):t===h&&(e.right="0px",e.bottom="0px"),e},P=function(t,e){var n=L(e),i="";return e===b?i+="red-safe":e===x?i+="green-safe":e===j?i+="yellow-safe":e===h&&(i+="blue-safe"),t.status===k&&t.playerTurn===e&&(i+=" blink "),Object(F.jsxs)("div",{className:"start ".concat(i),style:n,children:[Object(F.jsx)("div",{className:"start-circle start-circle--top"}),Object(F.jsx)("div",{className:"start-circle start-circle--top"}),Object(F.jsx)("div",{className:"start-circle start-circle--bottom"}),Object(F.jsx)("div",{className:"start-circle start-circle--bottom"})]},e)},G=function(t){return Object(F.jsxs)("div",{children:[P(t,b),P(t,x),P(t,j)," ",P(t,h)]})},I=n(1),R=function(t,e){var n="";if(t.status===v){var i=e.find((function(t){return 0===t.tokenRemaining}));n+="Game finished: ".concat(i.label," Wins.")}else if(t.status===g)n+="Game is not started - Click on the Start Game button";else{var o=e.find((function(e){return e.id===t.playerTurn}));n+="Waiting for ".concat(o.label),t.status===k?n+="- Click on the box to roll the dice":t.status===w&&(n+="- Select one of the tokens for the move")}return n},E=function(t,e,n,i){var o;t.playerTurn===b?o=x:t.playerTurn===x?o=j:t.playerTurn===j?o=h:t.playerTurn===h&&(o=b),e(Object(I.a)(Object(I.a)({},t),{},{playerTurn:o,status:k})),U(n,i)},U=function(t,e){e(t.map((function(t){return Object(I.a)(Object(I.a)({},t),{},{focussed:!1})})))},M=function(t){var e=t.token,n=t.game,i=t.players,o=t.updatePlayers,s=t.playerTokens,a=t.updatePlayerTokens,r=t.updateGame,u=t.cells;if(n.status===w&&e.focussed){var c=i.find((function(t){return t.id===e.player_id})),p=s.findIndex((function(t){return t.id===e.id})),d=function(t,e,n){var i=e.position,o=e.status;if(e.status===m)i=n.startCell,o=y;else for(;t;){for(i++;n.skippedCells.includes(i);)76===++i&&(i=0);t--,76===i&&(i=0)}return i===n.endCell&&(o=O),Object(I.a)(Object(I.a)({},e),{},{position:i,status:o})}(n.diceVal,e,c),f=s.findIndex((function(t){return t.position===d.position&&t.player_id!==d.player_id}));if(-1===f||u[d.position].station||(s[f].position=-1,s[f].status=m),s[p]=d,d.status===O){var b=i.findIndex((function(t){return t.id===d.player_id}));i[b].tokenRemaining--,0===i[b].tokenRemaining&&V(n,r,i[b]),o(Object(l.a)(i))}d.status===O||6===n.diceVal?function(t,e,n,i){e(Object(I.a)(Object(I.a)({},t),{},{status:k})),U(n,i)}(n,r,s,a):E(n,r,s,a)}},V=function(t,e,n){e(Object(I.a)(Object(I.a)({},t),{},{status:v,winner:n.id}))},W=function(t,e){var n=e.filter((function(e){return e.player_id===t.playerTurn&&e.focussed})),i=t.status===w;return!(0===n.length&&i)},A=function(t){var e=t.token,n=t.game,i=t.players,o=t.updatePlayers,s=t.playerTokens,a=t.updatePlayerTokens,r=t.updateGame,l=t.cells,u=function(t){var e={};return t.status===m?t.player_id===b?(e.left="150px",e.bottom="150px",1===t.id?(e.left="65px",e.bottom="185px"):2===t.id?(e.left="180px",e.bottom="185px"):3===t.id?(e.left="65px",e.bottom="55px"):4===t.id&&(e.left="180px",e.bottom="55px")):t.player_id===x?5===t.id?(e.left="65px",e.top="200px"):6===t.id?(e.left="180px",e.top="200px"):7===t.id?(e.left="65px",e.top="55px"):8===t.id&&(e.left="180px",e.top="55px"):t.player_id===j?9===t.id?(e.right="65px",e.top="200px"):10===t.id?(e.right="180px",e.top="200px"):11===t.id?(e.right="65px",e.top="55px"):12===t.id&&(e.right="180px",e.top="55px"):t.player_id===h&&(13===t.id?(e.right="65px",e.bottom="185px"):14===t.id?(e.right="180px",e.bottom="185px"):15===t.id?(e.right="65px",e.bottom="55px"):16===t.id&&(e.right="180px",e.bottom="55px")):t.status===O?t.player_id===b?(e.left="350px",e.bottom="300px"):t.player_id===x?(e.left="300px",e.top="350px"):t.player_id===j?(e.left="350px",e.bottom="400px"):t.player_id===h&&(e.left="400px",e.top="350px"):t.status===y&&-1!==t.position&&(e=_({id:t.position})),e}(e),c="";return e.player_id===b?c+="red-token":e.player_id===x?c+="green-token":e.player_id===j?c+="yellow-token":e.player_id===h&&(c+="blue-token"),n.status===w&&(n.playerTurn===b&&e.focussed?c+=" red-token--active blink":n.playerTurn===x&&e.focussed?c+=" green-token--active blink":n.playerTurn===j&&e.focussed?c+=" yellow-token--active blink":n.playerTurn===h&&e.focussed&&(c+=" blue-token--active blink")),Object(F.jsx)("div",{className:"token ".concat(c),style:u,onClick:function(){return M({token:e,game:n,players:i,updatePlayers:o,playerTokens:s,updatePlayerTokens:a,updateGame:r,cells:l})}},e.id)},J=function t(){Object(u.a)(this,t),this.status=g,this.turnCount=0,this.playerTurn=null,this.diceVal=null,this.winner=null};var B=n(8),D=n(10),H=n.n(D),Y=n(12);n(21);var q=function(t){t.user;var e=t.updateUser;return Object(F.jsxs)("div",{className:"login-wrapper",children:[Object(F.jsx)("h2",{children:"Login to play Ludo"}),Object(F.jsx)(B.GoogleLogin,{clientId:"386851791646-o7hhcfta2pdgri2hsipjaa695eeeovoj.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(t){console.log("Login Success: currentUser:",t.profileObj),e(t.profileObj.name),function(t){var e=1e3*(t.tokenObj.expires_in||3300),n=function(){var i=Object(Y.a)(H.a.mark((function i(){var o;return H.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.reloadAuthResponse();case 2:o=i.sent,e=1e3*(o.expires_in||3300),console.log("newAuthRes:",o),localStorage.setItem("authToken",o.id_token),setTimeout(n,e);case 7:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();setTimeout(n,e)}(t)},onFailure:function(t){console.log("Login failed: res:",t)},cookiePolicy:"single_host_origin",style:{marginTop:"100px"},isSignedIn:!0})]})};var z=function(t){return Object(F.jsx)("div",{children:Object(F.jsx)(B.GoogleLogout,{clientId:"386851791646-oiaar3v69kin8s10iuva8uouvjj5b3c7.apps.googleusercontent.com",buttonText:"Logout ".concat(t.user),onLogoutSuccess:function(){console.log("Logout made successfully"),t.updateUser(null)}})})};var K=function(){var t=Object(i.useState)(function(){T=0;var t=[];return t.push.apply(t,Object(l.a)(S(b,x))),t.push.apply(t,Object(l.a)(S(x,j))),t.push.apply(t,Object(l.a)(S(j,h))),t.push.apply(t,Object(l.a)(S(h,b))),t}()),e=Object(r.a)(t,2),n=e[0],o=(e[1],Object(i.useState)(function(){var t=[];return t.push(new N(b,"Player 1",1,75,69,[0,13,14,15,16,17,18,32,33,34,35,36,37,51,52,53,54,55,56])),t.push(new N(x,"Player 2",20,18,12,[19,32,33,34,35,36,37,51,52,53,54,55,56,70,71,72,73,74,75])),t.push(new N(j,"Player 3",39,37,31,[38,13,14,15,16,17,18,51,52,53,54,55,56,70,71,72,73,74,75])),t.push(new N(h,"Player 4",58,56,50,[57,13,14,15,16,17,18,32,33,34,35,36,37,70,71,72,73,74,75])),t}())),s=Object(r.a)(o,2),a=s[0],u=s[1],c=Object(i.useState)(function(){var t=[];return t.push(new C(1,b,-1)),t.push(new C(2,b,-1,m)),t.push(new C(3,b,-1,m)),t.push(new C(4,b,-1,m)),t.push(new C(5,x,-1)),t.push(new C(6,x,-1)),t.push(new C(7,x,-1)),t.push(new C(8,x,-1)),t.push(new C(9,j,-1)),t.push(new C(10,j,-1,m)),t.push(new C(11,j,-1)),t.push(new C(12,j,-1)),t.push(new C(13,h,-1)),t.push(new C(14,h,-1,m)),t.push(new C(15,h,-1)),t.push(new C(16,h,-1)),t}()),p=Object(r.a)(c,2),d=p[0],f=p[1],y=Object(i.useState)(new J),L=Object(r.a)(y,2),P=L[0],U=L[1],M=Object(i.useState)(null),V=Object(r.a)(M,2),B=V[0],D=V[1],H=function(){var t=Object(i.useState)(function(){var t=localStorage.getItem("token"),e=JSON.parse(t);return null===e||void 0===e?void 0:e.token}()),e=Object(r.a)(t,2),n=e[0],o=e[1];return{setToken:function(t){localStorage.setItem("token",JSON.stringify(t)),o(t.token)},token:n}}(),Y=(H.token,H.setToken,"");return P.status===k&&(Y+=" blink "),console.log(n),console.log(a),console.log(d),console.log(B),B?Object(F.jsxs)("div",{className:"app",children:[Object(F.jsx)("div",{className:"board-container",children:Object(F.jsxs)("div",{className:"board",children:[n.map((function(t){return function(t){var e="",n=_(t);return t.safeFor===b?e="red-safe":t.safeFor===x?e="green-safe":t.safeFor===j?e="yellow-safe":t.safeFor===h&&(e="blue-safe"),t.homeFor&&(t.safeFor===b?e+=" arrow-up":t.safeFor===x?e+=" arrow-right":t.safeFor===j?e+=" arrow-down":t.safeFor===h&&(e+=" arrow-left")),Object(F.jsx)("span",{className:"cell ".concat(e),style:n,children:t.station?Object(F.jsx)("span",{className:"cell--station",children:"\u2605"}):null},t.id)}(t)})),G(P),d.map((function(t){return A({token:t,game:P,players:a,updatePlayers:u,playerTokens:d,updatePlayerTokens:f,updateGame:U,cells:n})}))]})}),Object(F.jsxs)("div",{className:"controls",children:[Object(F.jsxs)("h2",{children:[" ",R(P,a)]}),Object(F.jsx)("div",{className:"dice".concat(Y),onClick:function(){return function(t,e,n,i,o){if(t.status===k){var s=1+Math.floor(6*Math.random());e(Object(I.a)(Object(I.a)({},t),{},{diceVal:s,status:w})),i(n.map((function(e){var n=o.find((function(t){return t.id===e.player_id}));return e.player_id===t.playerTurn&&(-1!==e.position||-1===e.position&&6===s)&&e.status!==O?e.position>=n.homeStartCell&&e.position<n.endCell&&e.position+s>n.endCell?e:Object(I.a)(Object(I.a)({},e),{},{focussed:!0}):e})))}}(P,U,d,f,a)},children:P.status===w?P.diceVal:null}),Object(F.jsx)("button",{className:"btn-primary",disabled:P.status!==v&&P.status!==g,onClick:function(){return function(t,e){e(Object(I.a)(Object(I.a)({},t),{},{status:k,turnCount:0,playerTurn:b}))}(P,U)},children:"Start Game"}),Object(F.jsx)("button",{className:"btn-secondary",disabled:W(P,d),onClick:function(){return E(P,U,d,f)},children:"Skip Turn"}),Object(F.jsx)("br",{}),Object(F.jsx)("hr",{}),Object(F.jsx)(z,{user:B,updateUser:D})]})]}):Object(F.jsx)(q,{user:B,updateUser:D})},Q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,24)).then((function(e){var n=e.getCLS,i=e.getFID,o=e.getFCP,s=e.getLCP,a=e.getTTFB;n(t),i(t),o(t),s(t),a(t)}))};a.a.render(Object(F.jsx)(o.a.StrictMode,{children:Object(F.jsx)(K,{})}),document.getElementById("root")),Q()}},[[22,1,2]]]);
//# sourceMappingURL=main.15872f13.chunk.js.map